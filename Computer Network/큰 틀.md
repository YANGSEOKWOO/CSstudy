
### 1장 | 웹브라우저

보여지는 동작 : 사용자가 URL을 입력한다.

행동 : 
#### 브라우저
1. 규칙에 따라 URL의 의미 조사
2. 의미에 따라, request 메시지를 만든다.
	1. ex) 'sample.html이라는 파일에 저장된 페이지의 데이터를 주세요'
3. 디지털 데이터를 운반하는 구조에게 의뢰한다.
	1. OS에 내장된 네트워크 제어용 소프트웨어에 의뢰하여 메시지를 서버측까지 도착하게 한다.

### 2장 | 프로토콜 스택, LAN 어댑터
데이터를 운반하는 구조

프로토콜 스택
- 브라우저에서 받은 메시지를 패킷 속에 저장한다.
- 수신처 주소 등의 제어 정보를 덧붙인다.
ex) 편지를 봉투에 넣고, 받는 사람의 정보를 쓰는 행위

LAN 어댑터(이더넷 or  무선 LAN으로 통신할 때 사용하는 하드웨어)에 넘긴다.
- 패킷을 전기 신호로 변환하고, LAN의 케이블에 송출한다.
	- => 패킷이 네트워크 속으로 들어간다.

### 3장 | 허브, 스위치, 라우터

인터넷에 접속하는 형태에 따라 달라진다.

클라이언트 PC는 가정 or 회사의 LAN을 경유하거나, 단독으로 인터넷에 접속할 수 있다.
- 하지만 여기에서는 가정, 회사 LAN에 접속된다고 한다.
ADSL이나 광섬유 등의 광대역 회선에 의해 인터넷에 접속된다는 상황을 가정한다.

1. LAN어댑터가 송신한 패킷 => 스위칭 허브 등을 경유하여 인터넷 접속용 라우터에 도착한다.
2. 라우터의 앞부분 : 통신사가 패킷을 상대에게 운반한다.

### 4장 | 액세스 회선, 프로바이더

라우터의 앞부분 : 인터넷의 내부
- 인터넷의 입구 : 액세스 회선(통신 회선)

액세스 회선은 provider에 연결되어 있다.

#### POP(Point Of Presense)
통신사용으로 만들어진 라우터
- 가장 가까운 우체국이라고 생각하면 된다.
우체국에서 회수한 편지 => 우체국에서 분류되어 전국, 전세계로 배송된다.
- 인터넷 또한, 액세스 회선 ~> POP까지 패킷 운반 -> 전국 or 전 세계로 배송한다.
POP의 앞부분 : 인터넷의 핵심부

다수의 통신사, 라우터가 설치되어 있다.
- 서로 연결된다.
- 라우터들끼리 연대하여 패킷을 목적지의 웹 서버쪽으로 운반한다.

통신사의 라우터
- 수십 개의 케이블을 접속할 수 있는 거대하고, 고속의 라우터
- 라우터들이 복잡하게 연결되어 있다.

이 라우터들 사이로 패킷이 흘러간다.
- 가정, 회사 LAN의 경우, 인터넷의 케이블로 연결될 뿐이지만
- 인터넷은 이더넷 케이블로 연결되어 있기만 한 것이 아니다. => 광통신

### 5장 | 방화벽, 캐시서버

패킷이 최종적으로 웹 서버 측의 LAN에 도착

1. 방화벽이 패킷을 검사한다.
2. 캐시서버에 들어간다. (페이지의 데이터 중 다시이용할 수 있는 데이터라면, 캐시 서버에 들어간다.)
	1. 액세스한 페이지의 데이터가 있다면, 웹서버에 의뢰하지 않고 데이터를 읽을 수 있다.
3. 대규모 웹사이트라면), 복수의 웹서버에 메시지를 분배하는 부하분산장치

이렇게 해서 패킷이 웹서버에 도착한다.

### 6장 | 웹 서버

1. 패킷의 알맹이를 추출한다. (원래 Request 메시지 복원)
2. 웹 서버 애플리케이션에 넘긴다. (OS에 내장된 프로토콜 스택의 역할)
3. Request 메시지를 읽고, 지시에 따라 데이터를 응답 메시지에 넣어 클라이언트에게 회송



----

## 패킷이 거치는 경로

#### 클라이언트
1.  맨 처음에 사용자가 URL 입력
2. URL을 웹 브라우저가 해석, HTTP 메시지를 만들어 Socket 라이브러리에 건네준다.
3. Socket 라이브러리가 HTTP메시지를 송신 데이터로 프로토콜 스택에 건네준다.
4. TCP가 송신 데이터를 패킷의 길이에 맞게 분할, TCP헤더 추가 후 IP에 건넨다.
5. IP는 TCP에서 받은 패킷에 IP헤더 추가, MAC주소 조사하여 MAC헤더도 부가, LAN 드라이버에 건넨다.
6. LAN 드라이버 : IP에서 송신 패킷을 받고, LAN 어댑터에 건네줘 송신하도록 지시
7. LAN 어댑터 : 이더넷이 송신가능한 상태라면, 패킷을 전기 신호로 변환 후 트위스트 페어 케이블에 내보낸다.
#### 클라이언트 측 LAN
8. 트위스트페어 케이블 속을 통해 리피터 허브에 도달
9. 리피터 허브 : 신호를 모든 포트로 보낸다. => 스위칭 허브에 도달
10. 스위칭 허브 : 도착한 패킷의 수신자 MC주소의 값 <=> 자기 속에 있는 주소 테이블 / 출력할 곳의 포트를 판단, 포트에 패킷을 중계
11. 라우터 : 도착한 패킷의 수신자 IP주소의 값 <=> 저장된 라우팅 테이블의 내용 / 출력포트 판단, 이 포트에 패킷을 중계
12. ADSL모뎀에 도착한 패킷, ATM셀로 분할
13. 전기 신호로 변환, 전화선에 내보낸다.

#### 액세스 회선
14. ADSL모뎀이 내보낸 신호 => 전화선을 통해 DSLAM(전화국용 집합 모뎀)에 도착
15. 전기신호 => ATM셀의 형태로 되돌린다. => 광대역 액세스 서버(BAS)에 보낸다.
16. BAS : ATM셀을 패킷의 형태로 만든다. 수신자주소를 보고 패킷을 중계한다.
17. 패킷 => L2TP 헤더가 붙어 터널 안으로 흘러간다.
18. 터널 출구에 있는 터널링용 라우터에 패킷이 도착하면, L2TP헤더와 PPP헤더가 분리되어 인터넷을 통과하여 웹 서버 측으로 흘러간다.

#### 웹 서버측 LAN
19. 서버 측의 LAN에는 방화벽이 있어, 이것을 통해 들어온 패킷을 검사하고, 통과 시킬지, 차단할 지를 판단한다.
20. 캐시서버가 있다면, 방화벽을 통과한 패킷을 캐시 서버가 가로챈다. 만약 요청 페이지가 캐시 서버에 있다면 웹서버를 대신해서 해당 페이지를 되돌려보낸다.
21. 아니라면 웹 서버로 보낸다.

#### 웹 서버
22. 패킷이 도착하면, LAN 어댑터, 드라이버가 패킷을 수신하고 프로토콜 스택에 건네준다.
23. IP헤더, TCP헤더를 차례대로 검사하여 오류가 없으면 패킷에서 HTTP 메시지 조각 추출, 원래의 모습으로 되돌림
24. HTTP메시지는 Socket라이브러리를 통해 웹 서버에 전달
25. 웹 서버 : HTTP메시지의 내용을 해석해서, 요청하는 내용에 따라 데이터를 추출하여 클라이언트에 반송한다.


